---
title: "Hepatectomy"
author: "Oscar J. Ponce & Eddy Lincango"
date: "18/11/2020"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(dpi=900)
knitr::opts_chunk$set(dev='svg')

library(webshot)
library(metafor)
library(tidyverse)
library(rmarkdown)
library(magrittr)
library(grid)
library(gt)
library(forestplot)
library(glue)
library(Gmisc)
library(Matrix)

```


```{r cleaning_continuous_donor, echo=FALSE, message=FALSE, warning=FALSE}
#continuous donor
h <- read.csv("6 Extracted Data/outcome_continuous_donor.csv")


h1<-h[!(h$analysis=='no'),]

names(h1)[6] <- "outcome"
names(h1)[8] <- "followup"
names(h1)[11] <- 'n1'
names(h1)[12] <- 'n2'
names(h1)[13] <- 'mean_post1'
names(h1)[14] <- 'sd_post1'
names(h1)[15] <- 'mean_post2'
names(h1)[16] <- 'sd_post2'

h1[11:16] <- sapply(h1[11:16],as.numeric)

h1$outcome[h1$outcome == 'Estimated blodd loss'] <- 'blood loss'
h1$outcome[h1$outcome == 'Estimated blood loss'] <- 'blood loss'

h1$intervention[h1$intervention == 'RlDRH'] <- 'RLDRH'

h1$author <- 
  ifelse(h1$refid==9, paste("Rho et al., 2020"),
  ifelse(h1$refid==27, paste("Broering et al., 2020"),
  ifelse(h1$refid==5, paste("Binoj et al., 2020"),
  ifelse(h1$refid==172, paste("Chen et al., 2016"),
  ifelse(h1$refid==74, paste("Cheah et al., 2019"),
  ifelse(h1$refid==239, paste("Martucci et al., 2013"),
  ifelse(h1$refid==277, paste("Giulianotti et al., 2011"), NA)))))))

#h1[h1$outcome == 'Liver funcion', c(1:3,5,6,7,11:16)]

```


```{r functions_md_rr, echo=FALSE, message=FALSE, warning=FALSE}
md <- function(database){
  
  db <- database
  db <- escalc(measure="MD", 
               m1i=mean_post1, m2i = mean_post2, 
               sd1i  = sd_post1, sd2i = sd_post2, 
               n1i = n1, n2i= n2, data=database)
  db$vi <- ifelse(is.na(db$vi), 
               ((db$mdul_post-db$mdll_post)/((2*abs(qt(0.05/2, db$total-1)))^2)), db$vi)
  db <- db[order(db$yi),]
  db <- summary(db)
  
  db$md <- paste(formatC(db$yi, format='f', digits =1)," ",
                 "(",formatC(db$ci.lb, format='f', digits =1),
                 ",",formatC(db$ci.ub, format='f', digits=1),")") 
  db$postmean1 <- paste(formatC(db$mean_post1, format='f', digits=1),'(', formatC(db$sd_post1, format='f', digits=1),')')
  db$postmean2 <- paste(formatC(db$mean_post2, format='f', digits=1),'(', formatC(db$sd_post2, format='f', digits=1),')')
  
  ma <- rma(yi, vi, measure='MD', data=db, method='REML')
  
  db$w <- paste(formatC(weights(ma), format='f', digits = 1),'%')
  db$weights <- weights(ma)
  
  list(pre = db, ma = ma)
}


table_md <- function(analysis, nstudies, int, comp, outcome, col, 
                     follow=FALSE){
   ifelse(nstudies>1,
        (b <- cbind( 
          c("Author", analysis$pre$author, 
            paste("Overall Mean Difference for", analysis$ma$k, "studies","\n", 
                  "(Tau^2 = ", (formatC(analysis$ma$tau2, digits=2, format="f")), ", df = ", 
                  (analysis$ma$k - analysis$ma$p),
                  ", p ", (ifelse(analysis$ma$QEp < 0.001, 
                                  paste("< 0.001"),
                                  paste("= ", formatC(analysis$ma$QEp, digits=3, format="f")))),
                  "; ", "I^2", " = ", (formatC(analysis$ma$I2, digits=1, format="f")), "%)")),
        c(paste(int), analysis$pre$n1, sum(analysis$pre$n1)),
        c(paste(outcome, '\n', col), analysis$pre$postmean1, NA),
        c(paste(comp), analysis$pre$n2,sum(analysis$pre$n2)),
        c(paste(outcome, '\n', col), analysis$pre$postmean2, NA),
        c("Mean Difference (95% CI)", analysis$pre$md, 
            paste(formatC(analysis$ma$b, format='f', digits =1), 
                  " (",formatC(analysis$ma$ci.lb, format='f', digits=1),
                  ",", formatC(analysis$ma$ci.ub, format='f', digits=1), ")")),
        c("Weight (%)", analysis$pre$w, NA))),
        (b <- cbind( 
        c("Author", analysis$pre$author),
        c(paste(int), analysis$pre$n1),
        c(paste(outcome,'\n', col), analysis$pre$postmean1),
        c(paste(comp), analysis$pre$n2),
        c(paste(outcome, '\n',col), analysis$pre$postmean2),
        c("Mean Difference (95% CI)", analysis$pre$md))))

  ifelse(follow==TRUE, 
          b <- cbind(b, c(paste('Follow-up'), analysis$pre$followup, NA)), NA)
  ifelse(follow==TRUE,
          b <- b[,c(1,ncol(b),2:(ncol(b)-1))], NA)
  
  
  b <- as_tibble(b) 
  b <- b %>% add_row(.before = 2)
  b <- b %>% add_row(.before = 2)
  b <- b %>% add_row(.after = nrow(b))
  
  ifelse(nstudies>1, b <- b %>% add_row(.before = nrow(b)-1), NA)

  
  ifelse(nstudies > 1,
        (c <- structure(list(
          mean = c(rep(NA, 3), analysis$pre$yi, NA, analysis$ma$b,NA),
          lower = c(rep(NA, 3), analysis$pre$ci.lb, NA, analysis$ma$ci.lb, NA),
          upper = c(rep(NA, 3), analysis$pre$ci.ub, NA, analysis$ma$ci.ub, NA)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, -1L*nrow(b)),
          class = "data.frame")),
        (c <- structure(list(
          mean = c(rep(NA, 3), analysis$pre$yi, NA),
          lower = c(rep(NA, 3), analysis$pre$ci.lb, NA),
          upper = c(rep(NA, 3), analysis$pre$ci.ub, NA)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, -1L*nrow(b)),
          class = "data.frame")))

  c <- as_tibble(c)
  
  list(b = b, c = c)
} 




plotmd_single_studies <- function(words, numbers,  
                                  xtick, sizes, bolding, aligning, fpPosition) {

  (forestplot(words,
             graph.pos = fpPosition,
             zero = 0,
             numbers,
             new_page = TRUE,
             colgap = unit(5, "mm"),
             hrzl_lines = list('3' = gpar (lwd=1, columns=c(1:(ncol(words)+1)), col="black")),
             lineheight=unit(0.7,'cm'),
             boxsize = sizes,
             line.margin = 2,
             is.summary = bolding,
             align = aligning,
             ci.vertices = TRUE,
             txt_gp = fpTxtGp(label =gpar (cex=0.9), 
                              ticks = gpar(cex = 0.9, fontface="bold"),
                              summary = gpar(cex = 0.9),
                              xlab = gpar(cex=0.9)),
             xticks = xtick,
             xlog=FALSE,
             clip = c(0,1),
             grid = xtick,
             lwd.xaxis = 1,
             lwd.ci = 2.2,
             lwd.zero = 1.5,
             graphwidth = unit(10,"cm"),
             col=fpColors(box="black",line="grey", zero = 'dodgerblue4', axes="grey20", summary="black")))
 
}








rr <- function(database){
  db <- database
  db <- escalc(measure="RR", ai=e1, ci=e2, n1i=n1, n2i=n2,data=database)
  db <- db[order(db$yi),]
  db <- summary(db)
  
  db$est <-  exp(db$yi)
  db$ci.lb <- exp(db$ci.lb)
  db$ci.ub <- exp(db$ci.ub)
  
  
  db$rate1 <- paste(db$e1,"/",db$n1)
  db$rate2 <- paste(db$e2,"/",db$n2)
  db$rr <- paste(formatC(db$est, format='f', digits =2)," ",
                 "(",formatC(db$ci.lb, format='f', digits =2),
                 "-",formatC(db$ci.ub, format='f', digits=2),")")  
  
  ma <- rma(db$yi, db$vi, measure='RR', data=db, method='REML')
  exp <- predict(ma, transf = transf.exp.int)
  
  db$weights <- weights(ma)
  db$w <- paste(formatC(db$weights, format='f', digits = 1),'%')
  
  
  list(pre = db, ma = ma, exp = exp)
}



table_rr <- function(analysis, int, comp, outcome, nstudies){
  ifelse(nstudies>1,
  b <- cbind( 
    c("Author", analysis$pre$author, 
      paste("Overall Relative Risk for", analysis$ma$k, "studies","\n", 
            "(Tau^2 = ", (formatC(analysis$ma$tau2, digits=2, format="f")), ", df = ", 
            (analysis$ma$k - analysis$ma$p),
            ", p ", (ifelse(analysis$ma$QEp < 0.001, 
                            paste("< 0.001"),
                            paste("= ", formatC(analysis$ma$QEp, digits=3, format="f")))),
            "; ", "I^2", " = ", (formatC(analysis$ma$I2, digits=1, format="f")), "%)")),
    c(paste(int, '\n', outcome,'/','total n'),analysis$pre$rate1, paste(sum(analysis$pre$e1), " / ",
                                                      sum(analysis$pre$n1))),
    c(paste(comp, '\n', outcome,'/', 'total n'),analysis$pre$rate2, paste(sum(analysis$pre$e2), " / ",
                                                        sum(analysis$pre$n2))),
    c("Relative Risk (95% CI)", analysis$pre$rr, 
      paste(formatC(analysis$exp$pred, format='f', digits =2), 
            " (",formatC(analysis$exp$ci.lb, format='f', digits=2),
            "-", formatC(analysis$exp$ci.ub, format='f', digits=2), ")")),
    c("Weight(%)", paste(formatC(weights(analysis$ma), format='f', digits = 1),'%'), NA)),
       b <- cbind( 
        c("Author", analysis$pre$author),
        c(paste(int, '\n', outcome,'/','total n'),analysis$pre$rate1),
        c(paste(comp, '\n', outcome,'/', 'total n'),analysis$pre$rate2),
        c("Relative Risk (95% CI)", analysis$pre$rr)))
  
  b <- as_tibble(b, .name_repair = "unique")
  b <- b %>% add_row(.before = 2)
  b <- b %>% add_row(.before = 2)
  b <- b %>% add_row(.after = nrow(b))  
  
  ifelse(nstudies>1, b <- b %>% add_row(.before = nrow(b)-1), NA)

  
  ifelse(nstudies > 1,
        (c <- structure(list(
          mean = c(rep(NA, 3), analysis$pre$est, NA, analysis$exp$pred,NA),
          lower = c(rep(NA, 3), analysis$pre$ci.lb, NA, analysis$exp$ci.lb, NA),
          upper = c(rep(NA, 3), analysis$pre$ci.ub, NA, analysis$exp$ci.ub, NA)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, -1L*nrow(b)),
          class = "data.frame")),
        (c <- structure(list(
          mean = c(rep(NA, 3), analysis$pre$est, NA),
          lower = c(rep(NA, 3), analysis$pre$ci.lb, NA),
          upper = c(rep(NA, 3), analysis$pre$ci.ub, NA)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, -1L*nrow(b)),
          class = "data.frame")))

  c <- as_tibble(c)
  
  list(b = b, c = c)
} 
  
  
  




plotrr_single_studies <- function(words, numbers, xtick, sizes, 
                                  bolding, aligning, fpPosition){
  
  forestplot(words,
             graph.pos = fpPosition,
             zero = 1,
             numbers,
             new_page = TRUE,
             colgap = unit(5, "mm"),
             hrzl_lines = list("3" = gpar (lwd=1, columns=c(1:(ncol(words)+1)), col="black")),
             lineheight=unit(0.7,'cm'),
             boxsize = sizes,
             line.margin = 2,
             is.summary = bolding,
             align = aligning,
             ci.vertices = TRUE,
             txt_gp = fpTxtGp(label =gpar (cex=0.9), 
                              ticks = gpar(cex = 0.9, fontface="bold"),
                              summary = gpar(cex = 0.9),
                              xlab = gpar(cex=0.9)),
             xticks = xtick,
             xlog=TRUE,
             clip = c(0.2, 32),
             grid = xtick,
             lwd.xaxis = 1,
             lwd.ci = 2.2,
             lwd.zero = 2,
             graphwidth = unit(10,"cm"),
             col=fpColors(box="black",line="grey", zero = 'dodgerblue4', axes="grey20", summary="black"))
  
  
}  




```



## Summary of forest plots - *Donors Patients*




### Supplementary Figure 1
<details><summary><b>Show figure</b> - Difference in mean total operative time (min) after RLDRH versus LADRH</summary>

```{r operativetime1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
surt <- subset(h1, outcome=='Total operative time')
surt1 <- subset(surt, comparison=='LADRH')

surt1_md <- md(surt1)

tsurt1 <- table_md(analysis = surt1_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Total operative time (min)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tsurt1$b,
                      numbers = tsurt1$c,
                      fpPosition = ncol(tsurt1$b),
                      xtick = c(250, 150, 50, 0, -50, -150, -250),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
```


</details>




### Supplementary Figure 2
<details><summary><b>Show figure</b> - Difference in mean total operative time (min) after RLDRH versus ODRH</summary>

```{r operativetime2, fig.height=3, fig.width=17, echo=FALSE, message=FALSE, warning=FALSE}
surt2 <- subset(surt, comparison=='ODRH')

surt2_md <- md(surt2)

tsurt2 <- table_md(analysis = surt2_md, nstudies = 3, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Total operative time (min)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tsurt2$b,
                      numbers = tsurt2$c,
                      fpPosition = ncol(tsurt2$b)-1,
                      xtick = c(-150, -50, 0, 50, 150, 250, 350),
                      sizes = c(rep(NA,3), 0.02*(surt2_md$pre$weights),NA, 1, NA),
                      bolding = c(T, rep(F, 7), T, F),
                      aligning = c('l', rep('c', 4), 'l', 'l'))

```

</details>

  
### Supplementary figure 3 
<details><summary> <b>Show figure</b> - Difference in mean blood loss (mL) after RLDRH versus LADRH</summary> 
  
```{r blood_loss_1, fig.height=3, fig.width=13, echo=FALSE, message=FALSE, warning=FALSE}
blood <- subset(h1, outcome=='blood loss')
blood1 <- subset(blood, comparison=='LADRH')

blood1_md <- md(blood1)

tblood1 <- table_md(analysis = blood1_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Blood loss (mL)', col = 'Mean (SD)',
                    follow = FALSE)

plot <- plotmd_single_studies(words = tblood1$b,
                              numbers = tblood1$c,
                              fpPosition = ncol(tblood1$b),
                              xtick = c(-250, -150, -50,0, 50, 150), 
                              sizes = c(rep(NA,3), 1, NA),
                              bolding = c(T, F, F,T,F),
                              aligning = c('l',rep('c',4),'l'))
```

</details>
  
  
  
### Supplementary figure 4
<details><summary><b>Show figure</b> - Difference in mean blood loss (mL) after RLDRH versus ODRH </summary>
  
```{r blood_loss2, fig.height = 3, fig.width = 16, echo=FALSE, fig.retina = 2, message=FALSE, warning=FALSE}
blood2 <- subset(blood, comparison=='ODRH')

blood2_md <- md(blood2)

tblood2 <- table_md(analysis = blood2_md, nstudies = 4, 
                    int = "ODRH (n)", comp = "LADRH (n)",
                    outcome = 'Blood Loss (mL)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tblood2$b,
                              numbers = tblood2$c,
                              fpPosition = ncol(tblood2$b)-1,
                              xtick = c(-250, -150, -50, 0, 50, 150, 250), 
                              sizes = c(rep(NA,3), 0.011*(blood2_md$pre$weights+50), NA, 1,NA),
                              bolding = c(T, rep(F, 7), T, F),
                              aligning = c('l', rep('c', 4), 'l', 'l'))

```

</details>

  
  
### Supplementary figure 5
<details><summary><b>Show figure</b> - Difference in mean peak ALT levels  (IU/L) after RLDRH versus LADRH</summary>
  
```{r alt1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
alt <- subset(h1, outcome=='Peak ALT level')

alt1 <- subset(alt, comparison=='LADRH')


alt1_md <- md(alt1)

talt1 <- table_md(analysis = alt1_md, nstudies = 1, 
                  int = "RLDRH (n)", comp = "LADRH (n)",
                  outcome = 'Peak ALT Level (IU/L)', col = 'Mean (SD)', 
                  follow = FALSE)


plot <- plotmd_single_studies(words = talt1$b,
                              numbers = talt1$c,
                              fpPosition = ncol(talt1$b),
                              xtick = c(-50, 0, 50, 150),
                              sizes = c(rep(NA,3), 1, NA),
                              bolding = c(T, rep(F, 2), T, F),
                              aligning = c('l', rep('c', 4), 'l'))

```

</details>

  
### Supplementary figure 6
<details><summary><b>Show figure</b> - Difference in mean peak ALT levels (IU/L) after RLDRH versus ODRH</summary>
  
```{r alt2, fig.height=3, fig.width=17, echo=FALSE, message=FALSE, warning=FALSE}
alt2 <- subset(alt, comparison=='ODRH')


alt2_md <- md(alt2)

talt2 <- table_md(analysis = alt2_md, nstudies = 3, 
                  int = "RLDRH (n)", comp = "ODRH (n)",
                  outcome = 'Peak ALT Level (IU/L)', col = 'Mean (SD)', 
                  follow = FALSE)


plot <- plotmd_single_studies(words = talt2$b,
                              numbers = talt2$c,
                              fpPosition = ncol(talt2$b)-1,
                              xtick = c(-250, -150,-50, 0, 50, 150, 250),
                              sizes = c(rep(NA,3), 0.02*(alt2_md$pre$weights),NA, 1, NA),
                              bolding = c(T, rep(F, 6), T, F),
                              aligning = c('l', rep('c', 4), 'l', 'l'))

```


</details>


### Supplementary figure 7
<details><summary><b>Show figure</b> - Difference in mean peak AST levels (IU/L) after RLDRH versus LADRH</summary>

```{r ast1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
ast <- subset(h1, outcome=='Peak AST level')
ast1 <- subset(ast, comparison=='LADRH')

ast1_md <- md(ast1)

tast1 <- table_md(analysis = ast1_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Peak AST Level (IU/L)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tast1$b,
                      numbers = tast1$c,
                      fpPosition = ncol(tast1$b),
                      xtick = c(-50, 0, 50, 150),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
```

</details>


### Supplementary figure 8
<details><summary><b>Show figure</b> - Difference in mean peak AST levels (IU/L) after RLDRH versus ODRH</summary>

```{r ast2, fig.height=3, fig.width=17, echo=FALSE, message=FALSE, warning=FALSE}
ast2 <- subset(ast, comparison=='ODRH')

ast2_md <- md(ast2)

tast2 <- table_md(analysis = ast2_md, nstudies = 3, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Peak AST Level (IU/L)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tast2$b,
                      numbers = tast2$c,
                      fpPosition = ncol(tast2$b)-1,
                      xtick = c(-250, -150,-50, 0, 50, 150, 250),
                      sizes = c(rep(NA,3), 0.02*(ast2_md$pre$weights),NA, 1, NA),
                      bolding = c(T, rep(F, 6), T, F),
                      aligning = c('l', rep('c', 4), 'l', 'l'))

```

</details>

### Supplementary figure 9
<details><summary><b>Show figure</b> - Difference in mean peak total bilirubin levels (mg/dL) after RLDRH versus LADRH</summary>

```{r bilirubin1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
bil <- subset(h1, outcome=='Peak Total Bilirubin')
bil1 <- subset(bil, comparison=='LADRH')

bil1_md <- md(bil1)

tbil1 <- table_md(analysis = bil1_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Peak Total Bilirubin (mg/dL)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tbil1$b,
                      numbers = tbil1$c,
                      fpPosition = ncol(tbil1$b),
                      xtick = c(-2,-1,0, 1,2),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
```

</details>



### Supplementary figure 10
<details><summary><b>Show figure</b> - Difference in peak total bilirubin levels (mg/dL) after RLDRH versus ODRH</summary>

```{r bilirubin2, fig.height=3, fig.width=17, echo=FALSE, message=FALSE, warning=FALSE}
bil2 <- subset(bil, comparison=='ODRH')

bil2_md <- md(bil2)

tbil2 <- table_md(analysis = bil2_md, nstudies = 3, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Peak Total Bilirubin (mg/dL)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tbil2$b,
                      numbers = tbil2$c,
                      fpPosition = ncol(tbil2$b)-1,
                      xtick = c(-2,-1,0, 1,2),
                      sizes = c(rep(NA,3), 0.02*(bil2_md$pre$weights),NA, 1, NA),
                      bolding = c(T, rep(F, 6), T, F),
                      aligning = c('l', rep('c', 4), 'l', 'l'))
```


</details>

### Supplementary figure 11
<details><summary><b>Show figure</b> - Difference in mean pain scores (VAS) after RLDRH versus LADRH</summary>

```{r pain2, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
pain <- subset(h1, outcome=='Pain score')

pain1 <- subset(pain, comparison=='LADRH')

pain2_fu1 <- subset(pain1, followup=='day 0-1')
pain2_fu1 <- md(pain2_fu1)
tpain2_fu1 <- table_md(analysis = pain2_fu1, nstudies = 1, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Pain score (VAS)', col = 'Mean (SD)', follow = TRUE)


pain2_fu2 <- subset(pain1, followup=='day 2-3')
pain2_fu2 <- md(pain2_fu2)
tpain2_fu2 <- table_md(analysis = pain2_fu2, nstudies = 1, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Pain score (VAS)', col = 'Mean (SD)', follow= TRUE)



pain2_fu3 <- subset(pain1, followup=='day >3')
pain2_fu3 <- md(pain2_fu3)
tpain2_fu3 <- table_md(analysis = pain2_fu3, nstudies = 1, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Pain score (VAS)', col = 'Mean (SD)', follow= TRUE)


b <- rbind(tpain2_fu1$b[c(1:4),], 
           tpain2_fu2$b[c(3,4),],
           tpain2_fu3$b[c(3:5),])

c <- rbind(tpain2_fu1$c[c(1:4),], 
           tpain2_fu2$c[c(3,4),],
           tpain2_fu3$c[c(3:5),])

c <- structure(list(
          mean = c(c$mean),
          lower = c(c$lower),
          upper = c(c$upper)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, (-1L*nrow(c))),
          class = "data.frame")

plot <- plotmd_single_studies(words = b, 
                              numbers = c, 
                              fpPosition = ncol(b),
                      xtick = c(-2, -1, -0.5, 0, 0.5, 1, 2),
                      sizes = c(rep(NA,3), rep(c(1,NA),3)),
                      bolding = c(T, F, F, rep(c(T, F), 3)),
                      aligning = c('l', 'l', rep('c', 4), 'l'))

```


</details>



<details><summary> Supp Fig 12: RLDRH versus ODRH - Difference in mean pain scores (VAS) at day 0-1 </summary>
<p>
```{r pain3_analysis, fig.height=3, fig.width=18, echo=FALSE, message=FALSE, warning=FALSE}
pain2 <- subset(pain, comparison=='ODRH')


pain3_fu1 <- subset(pain2, followup=='day 0-1')
pain3_fu1 <- md(pain3_fu1)
tpain3_fu1 <- table_md(analysis = pain3_fu1, nstudies = 3, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Pain score (VAS)', col = 'Mean (SD)', follow=FALSE)


pain3_fu2 <- subset(pain2, followup=='day 2-3')
pain3_fu2 <- md(pain3_fu2)
tpain3_fu2 <- table_md(analysis = pain3_fu2, nstudies = 3, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Pain score (VAS)', col = 'Mean (SD)', follow=FALSE)



pain3_fu3 <- subset(pain2, followup=='day >3')
pain3_fu3 <- md(pain3_fu3)
tpain3_fu3 <- table_md(analysis = pain3_fu3, nstudies = 3, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Pain score (VAS)', col = 'Mean (SD)', follow=FALSE)


words <- rbind(tpain3_fu1$b[c(1:3,8),],
               tpain3_fu2$b[c(6,7),],
               tpain3_fu3$b[c(6:8),])
words[1,1] <- 'Follow-up'
words[4,1] <- 'Day 0-1'
words[6,1] <- 'Day 2-3'
words[8,1] <- 'Day >3'

words <- words[,-c(3,5,7)]
nstudies <- c(paste('Number','\n','of studies'), NA, NA, pain3_fu1$ma$k.all,
              NA, pain3_fu2$ma$k.all, 
              NA, pain3_fu3$ma$k.all, 
              NA)
i2 <- c('I2', NA, NA, paste(formatC(pain3_fu1$ma$I2, digits=0, format="f"), '%'),
        NA, paste(formatC(pain3_fu2$ma$I2, digits=0, format="f"), '%'),
        NA, paste(formatC(pain3_fu3$ma$I2, digits=0, format="f"), '%'), 
        NA)

b <- cbind(words[1], nstudies, words[c(2,3)], i2, words[4])

colnames(b) <- NULL


c <- rbind(tpain3_fu1$c[c(1:3,8),],
               tpain3_fu2$c[c(6,7),],
               tpain3_fu3$c[c(6:8),])


numbers <- structure(list(
          mean = c(c$mean),
          lower = c(c$lower),
          upper = c(c$upper)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, (-1L*nrow(c))),
          class = "data.frame")

plot <- plotmd_single_studies(words = b, 
                              numbers = c, 
                              fpPosition = ncol(b),
                      xtick = c(-2, -1, -0.5, 0, 0.5, 1, 2),
                      sizes = c(rep(NA,3), rep(c(1,NA),3)),
                      bolding = c(T, F, F, rep(c(T, F), 3)),
                      aligning = c('l', rep('c', 4), 'l'))

```


```{r pain2_followup1, fig.height=3, fig.width=15, echo=FALSE, message=FALSE, warning=FALSE}

plot <- plotmd_single_studies(words = tpain3_fu1$b, 
                              numbers = tpain3_fu1$c, 
                              fpPosition = ncol(tpain3_fu1$b)-1,
                              xtick =  c(-2, -1, 0, 1, 2),
                              sizes = c(rep(NA,3), 0.011*(pain3_fu1$pre$weights),NA, 1, NA),
                              bolding = c(T, rep(F,2), rep(F, 3), F, T, F),
                              aligning = c('l', rep('c', 4), 'l', 'l'))

```
</p>
</details>

<details><summary> Supp Fig 13: RLDRH versus ODRH - Difference in pain scores (VAS) at day 2-3 </summary>
<p>
```{r pain2_followup2, fig.height=3, fig.width=15, echo=FALSE, message=FALSE, warning=FALSE}
plot <- plotmd_single_studies(words = tpain3_fu2$b, 
                              numbers = tpain3_fu2$c, 
                              fpPosition = ncol(tpain3_fu2$b)-1,
                              xtick =  c(-2, -1, 0, 1, 2),
                              sizes = c(rep(NA,3), 0.011*(pain3_fu2$pre$weights),NA, 1, NA),
                              bolding = c(T, rep(F,2), rep(F, 2), F, T, F),
                              aligning = c('l', rep('c', 4), 'l', 'l'))

```
</p>
</details>
  
<details><summary> Supp Fig 14: RLDRH versus ODRH - Difference in pain scores (VAS) at day greater than 3 </summary>
<p>
```{r pain2_followup3, fig.height=3, fig.width=15, echo=FALSE, message=FALSE, warning=FALSE}
plot <- plotmd_single_studies(words = tpain3_fu3$b, 
                              numbers = tpain3_fu3$c, 
                              fpPosition = ncol(tpain3_fu3$b)-1,
                              xtick =  c(-2, -1, 0, 1, 2),
                              sizes = c(rep(NA,3), 0.011*(pain3_fu3$pre$weights),NA, 1, NA),
                              bolding = c(T, rep(F,2), rep(F, 2), F, T, F),
                              aligning = c('l', rep('c', 4), 'l', 'l'))

```
</p>
</details>

<br />




### Supplementary figure 15
<details><summary><b>Show figure</b> - Difference in mean length of hospital stay (days) after RLDRH versus LADRH</summary>

```{r hospital1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
hospital <- subset(h1, outcome=='Hospital stay')
hospital1 <- subset(hospital, comparison=='LADRH')

hospital1_md <- md(hospital1)

thospital1 <- table_md(analysis = hospital1_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Length of stay (days)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = thospital1$b,
                      numbers = thospital1$c,
                      fpPosition = ncol(thospital1$b),
                      xtick = c(-2, -1,  0,  1, 2),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
```
</details>



### Supplementary figure 16
<details><summary><b>Show figure</b> - Difference in mean length of hospital stay (days) after RLDRH versus ODRH</summary>

```{r hospital2, fig.height=3, fig.width=16, echo=FALSE, message=FALSE, warning=FALSE}
hospital2 <- subset(hospital, comparison=='ODRH')

hospital2_md <- md(hospital2)

thospital2 <- table_md(analysis = hospital2_md, nstudies = 3, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Length of stay (days)', col = 'Mean (SD)')



plot <- plotmd_single_studies(words = thospital2$b,
                      numbers = thospital2$c,
                      fpPosition = ncol(thospital2$b)-1,
                      xtick = c(-3, -2, -1, -0.5, 0, 0.5, 1, 2),
                      sizes = c(rep(NA,3), 0.011*(hospital2_md$pre$weights+50), NA, 1,NA),
                      bolding = c(T, rep(F, 7), T, F),
                      aligning = c('l', rep('c', 4), 'l', 'l'))

```
</details>






# Overall 
```{r overall_continuous_donor, fig.height=10, fig.width=17, echo=FALSE, message=FALSE, warning=FALSE}

a <- c('Outcome', 'N of studies', 
       'Amr1 (n)', 'Arm2 (n)', 
       'I2', 
       paste0('Mean Difference (MD)','\n','95%CI'), 
       paste0('Figure with','\n', 'Detailed Information'))

b <- c('Mean total operative time (min)', rep(NA, 6))
c <- c(paste0(surt1$intervention, ' vs ', surt1$comparison), surt1_md$ma$k, 
       sum(surt1$n1), sum(surt1$n2), 'NA', tsurt1$b[[4,6]], 
       'Suppl Fig #1')
d <- c(paste0(unique(surt2$intervention), ' vs ', unique(surt2$comparison)), surt2_md$ma$k, 
       sum(surt2$n1), sum(surt2$n2), 
       ifelse(surt2_md$ma$k == 1, paste('NA'), paste0(formatC(surt2_md$ma$I2, format='f', digits=0), '%')),
       tsurt2$b[[9,6]], 
       'Suppl Fig #2')


e <- c('Mean blood loss (mL)', rep(NA, 6))
f <- c(paste0(unique(blood1$intervention), ' vs ', unique(blood1$comparison)), blood1_md$ma$k, 
       sum(blood1$n1), sum(blood1$n2), 'NA', tblood1$b[[4,6]], 
       'Suppl Fig #3')
g <- c(paste0(unique(blood2$intervention), ' vs ', unique(blood2$comparison)), blood2_md$ma$k, 
       sum(blood2$n1), sum(blood2$n2), 
       ifelse(blood2_md$ma$k == 1, paste('NA'), paste0(formatC(blood2_md$ma$I2, format='f', digits=0),'%')),
       tblood2$b[[9,6]], 
       'Suppl Fig #4')



h <- c('Mean peak ALT levels (UI/L)', rep(NA, 6))
i <- c(paste0(unique(alt1$intervention), ' vs ', unique(alt1$comparison)), alt1_md$ma$k, 
       sum(alt1$n1), sum(alt1$n2), 
       ifelse(alt1_md$ma$k == 1, paste('NA'), paste0(formatC(alt1_md$ma$I2, format='f', digits=0),'%')),
       talt1$b[[4,6]], 
       'Suppl Fig #5')
j <- c(paste0(unique(alt2$intervention), ' vs ', unique(alt2$comparison)), alt2_md$ma$k, 
       sum(alt2$n1), sum(alt2$n2), 
       ifelse(alt2_md$ma$k == 1, paste('NA'), paste0(formatC(alt2_md$ma$I2, format='f',                digits=0),'%')),
       talt2$b[[8,6]], 
       'Suppl Fig #6')

k <- c('Mean peak AST levels (UI/L)', rep(NA, 6))
l <- c(paste0(unique(ast1$intervention), ' vs ', unique(ast1$comparison)), ast1_md$ma$k, 
       sum(ast1$n1), sum(ast1$n2), 
       ifelse(ast1_md$ma$k == 1, paste('NA'), paste0(formatC(ast1_md$ma$I2, format='f', digits=0),'%')),
       tast1$b[[4,6]], 
       'Suppl Fig #7')
m <- c(paste0(unique(ast2$intervention), ' vs ', unique(ast2$comparison)), ast2_md$ma$k, 
       sum(ast2$n1), sum(ast2$n2), 
       ifelse(ast2_md$ma$k == 1, paste('NA'), paste0(formatC(ast2_md$ma$I2, format='f',                digits=0),'%')),
       tast2$b[[8,6]], 
       'Suppl Fig #8')



n <- c('Mean bilirubin levels (mg/dL)', rep(NA, 6))
o <- c(paste0(unique(bil1$intervention), ' vs ', unique(bil1$comparison)), bil1_md$ma$k, 
       sum(bil1$n1), sum(bil1$n2), 
       ifelse(bil1_md$ma$k == 1, paste0('NA'), paste0(formatC(bil1_md$ma$I2, format='f', digits=0),'%')),
       tbil1$b[[4,6]], 
       'Suppl Fig #9')
p <- c(paste0(unique(bil2$intervention), ' vs ', unique(bil2$comparison)), bil2_md$ma$k, 
       sum(bil2$n1), sum(bil2$n2), 
       ifelse(bil2_md$ma$k == 1, paste0('NA'), paste0(formatC(bil2_md$ma$I2, format='f',                digits=0),'%')),
       tbil2$b[[8,6]], 
       'Suppl Fig #10')


q <- c('Mean pain scores (VAS)', rep(NA, 6))



r <- c(paste0(unique(pain2_fu1$pre$intervention), ' vs ', unique(pain2_fu1$pre$comparison), ' (',
        paste0(unique(pain2_fu1$pre$followup)), ') '), pain2_fu1$ma$k, 
       sum(pain2_fu1$pre$n1), sum(pain2_fu1$pre$n2), 
       ifelse(pain2_fu1$ma$k == 1, paste0('NA'), paste0(formatC(pain2_fu1$ma$I2, format='f', digits=0),'%')),
       tpain2_fu1$b[[4,7]], 
       'Suppl Fig #11')


s <- c(paste0(unique(pain2_fu2$pre$intervention), ' vs ', unique(pain2_fu2$pre$comparison), ' (',
        paste0(unique(pain2_fu2$pre$followup)), ') '), pain2_fu2$ma$k, 
       sum(pain2_fu2$pre$n1), sum(pain2_fu2$pre$n2), 
       ifelse(pain2_fu2$ma$k == 1, paste0('NA'), paste0(formatC(pain2_fu2$ma$I2, format='f', digits=0),'%')),
       tpain2_fu2$b[[4,7]], 
       'Suppl Fig #11')
t <- c(paste0(unique(pain2_fu3$pre$intervention), ' vs ', unique(pain2_fu3$pre$comparison), ' (',
        paste0(unique(pain2_fu3$pre$followup)), ') '), pain2_fu3$ma$k, 
       sum(pain2_fu3$pre$n1), sum(pain2_fu3$pre$n2), 
       ifelse(pain2_fu3$ma$k == 1, paste0('NA'), paste0(formatC(pain2_fu3$ma$I2, format='f', digits=0),'%')),
       tpain2_fu3$b[[4,7]], 
       'Suppl Fig #11')

                  

u <- c(paste0(unique(pain3_fu1$pre$intervention), ' vs ', unique(pain3_fu1$pre$comparison), ' (',
        paste0(unique(pain3_fu1$pre$followup)), ') '), pain3_fu1$ma$k, 
       sum(pain3_fu1$pre$n1), sum(pain3_fu1$pre$n2), 
       ifelse(pain3_fu1$ma$k == 1, paste0('NA'), paste0(formatC(pain3_fu1$ma$I2, format='f', digits=0),'%')),
       tpain3_fu1$b[[8,6]], 
       'Suppl Fig #12')
v <- c(paste0(unique(pain3_fu2$pre$intervention), ' vs ', unique(pain3_fu2$pre$comparison), ' (',
        paste0(unique(pain3_fu2$pre$followup)), ') '), pain3_fu2$ma$k, 
       sum(pain3_fu2$pre$n1), sum(pain3_fu2$pre$n2), 
       ifelse(pain3_fu2$ma$k == 1, paste0('NA'), paste0(formatC(pain3_fu2$ma$I2, format='f', digits=0),'%')),
       tpain3_fu2$b[[7,6]], 
       'Suppl Fig #13')
w <- c(paste0(unique(pain3_fu3$pre$intervention), ' vs ', unique(pain3_fu3$pre$comparison), ' (',
        paste0(unique(pain3_fu3$pre$followup)), ') '), pain3_fu3$ma$k, 
       sum(pain3_fu3$pre$n1), sum(pain3_fu3$pre$n2), 
       ifelse(pain3_fu3$ma$k == 1, paste0('NA'), paste0(formatC(pain3_fu3$ma$I2, format='f', digits=0),'%')),
       tpain3_fu3$b[[7,6]], 
       'Suppl Fig #14')



x <- c('Mean hospital length of stay (days)', rep(NA, 6))
y <- c(paste0(unique(hospital1$intervention), ' vs ', unique(hospital1$comparison)), hospital1_md$ma$k, 
       sum(hospital1$n1), sum(hospital1$n2), 
       ifelse(hospital1_md$ma$k == 1, paste0('NA'), paste0(formatC(hospital1_md$ma$I2, format='f', digits=0),'%')),
       thospital1$b[[4,6]], 
       'Suppl Fig #15')
z <- c(paste0(unique(hospital2$intervention), ' vs ', unique(hospital2$comparison)), hospital2_md$ma$k, 
       sum(hospital2$n1), sum(hospital2$n2), 
       ifelse(hospital2_md$ma$k == 1, paste0('NA'), paste0(formatC(hospital2_md$ma$I2, format='f',                digits=0),'%')),
       thospital2$b[[9,6]], 
       'Suppl Fig #16')

overall1 <- rbind(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z)
overall1 <- as.data.frame(overall1)

rownames(overall1) <- NULL

overall1 <- overall1 %>% add_row(.after = 1)
overall1 <- overall1 %>% add_row(.after = 5)
overall1 <- overall1 %>% add_row(.after = 9)
overall1 <- overall1 %>% add_row(.after = 13)
overall1 <- overall1 %>% add_row(.after = 17)
overall1 <- overall1 %>% add_row(.after = 21)
overall1 <- overall1 %>% add_row(.after = 29)
overall1 <- overall1 %>% add_row(.after = 33)


sub1 <- c(4,5,8,9,12,13,16,17,20,21,24:29,32,33) 
overall1[,1][sub1] <- paste("      ",overall1[,1][sub1])



toverall <- rbind(NA, NA, NA, tsurt1$c[4,], tsurt2$c[9,],
                  NA, NA, tblood1$c[4,], tblood2$c[9,],
                  NA, NA, talt1$c[4,], talt2$c[8,],
                  NA, NA, tast1$c[4,], tast2$c[8,],
                  NA, NA, tbil1$c[4,], tbil2$c[8,],
                  NA, NA, tpain2_fu1$c[4,], tpain2_fu2$c[4,], tpain2_fu3$c[4,],
                  tpain3_fu1$c[8,], tpain3_fu2$c[7,], tpain3_fu3$c[7,],
                  NA, NA, thospital1$c[4,], thospital2$c[9,], NA)


toverall <- structure(list(
          mean = c(toverall$mean),
          lower = c(toverall$lower),
          upper = c(toverall$upper)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, (-1L*nrow(toverall))),
          class = "data.frame")


forestplot(overall1,
             graph.pos = 6,
             zero = 0,
             toverall,
             new_page = TRUE,
             colgap = unit(5, "mm"),
             hrzl_lines = list("3" = gpar (lwd=1, columns=c(1:8), col="black")),
             lineheight=unit(0.7,'cm'),
             boxsize = 0.5,
             line.margin = 2,
             is.summary = c(T, F, T, rep(F,3), T, rep(F,3), T, rep(F,3), T, rep(F,3), T, rep(F,3),
                            T, rep(F, 7), T, rep(F,3)),
             align = c('l', rep('c',4), 'l'),
             ci.vertices = TRUE,
             txt_gp = fpTxtGp(label =gpar (cex=0.9), 
                              ticks = gpar(cex = 0.9, fontface="bold"),
                              summary = gpar(cex = 0.9),
                              xlab = gpar(cex=0.9)),
             xticks = c(-150,-50,-10,0,10,50,150),
             xlog=FALSE,
             clip = c(0.2, 32),
             grid = c(-150,-50,-10,0,10,50,150),
             lwd.xaxis = 1,
             lwd.ci = 2.2,
             lwd.zero = 2,
             graphwidth = unit(10,"cm"),
             col=fpColors(box="black",line="grey", zero = 'dodgerblue4', axes="grey20", summary="black"))




```





```{r cleaning_dichotomous_donor, echo=FALSE, message=FALSE, warning=FALSE}
d <- read.csv("6 Extracted Data/outcome_dichotomous_donor.csv")
d$outcomes2 <- paste(d$outcomes, d$definition)
d$comparison[d$comparison == 'NR'] <- NA

d2 <- d[!is.na(d$comparison),]

names(d2)[10] <- "n1"
names(d2)[11] <- "n2"
names(d2)[12] <- "e1"
names(d2)[13] <- "e2"

d2$comparison[d2$comparison == 'ORLDH'] <- 'ODRH'

d2[,c(9:13)] <- lapply(d2[,c(9:13)], as.numeric)


d2$author <- 
  ifelse(d2$refid==9, paste("Rho et al., 2020"),
  ifelse(d2$refid==27, paste("Broering et al., 2020"),
  ifelse(d2$refid==5, paste("Binoj et al., 2020"),
  ifelse(d2$refid==172, paste("Chen et al., 2016"),
  ifelse(d2$refid==74, paste("Cheah et al., 2019"),
  ifelse(d2$refid==239, paste("Martucci et al., 2013"),
  ifelse(d2$refid==277, paste("Giulianotti et al., 2011"), NA)))))))

```





### Figure 16
<details><summary><b>Show figure</b> - Risk of postoperative complications Clevien-Dindo I-II at 30 days after RLDRH versus LADRH</summary>

```{r LADRH_complication1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
compLADRH <- subset(d2, comparison=='LADRH')

comp1 <- subset(compLADRH, definition=='I-II')

comp1_rr <- rr(comp1)

tcomp1 <- table_rr(analysis = comp1_rr, nstudies = 1, 
                    int = "RLDRH", comp = "LADRH",
                    outcome = 'Complications I-II')


plot <- plotrr_single_studies(words = tcomp1$b,
                      numbers = tcomp1$c,
                      fpPosition = ncol(tcomp1$b),
                      xtick = c(0.2,0.5,1,2,4),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 2), 'l'))
```
</details>



### Figure 17
<details><summary><b>Show figure</b> - Risk of postoperative complications Clevien-Dindo III-IV at 30 days after RLDRH versus LADRH</summary>


```{r LADRH_complication2, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
comp2 <- subset(compLADRH, definition=='III-IV')

comp2_rr <- rr(comp2)

tcomp2 <- table_rr(analysis = comp2_rr, nstudies = 1, 
                    int = "RLDRH", comp = "LADRH",
                    outcome = 'Complications III-IV')


plot <- plotrr_single_studies(words = tcomp2$b,
                      numbers = tcomp2$c,
                      fpPosition = ncol(tcomp2$b),
                      xtick = c(0.06, 0.25,0.5,1,2,4, 16),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 2), 'l'))
```
</details>



### Figure 18
<details><summary><b>Show figure</b> - Risk of postoperative Clevien-Dindo complications I-II at 30 days after RLDRH versus ODRH</summary>

```{r ODRH_complication1, fig.height=3, fig.width=15, echo=FALSE, message=FALSE, warning=FALSE}
compODRH <- subset(d2, comparison=='ODRH')

comp3 <- subset(compODRH, definition=='I-II')

comp3_rr <- rr(comp3)

tcomp3 <- table_rr(analysis = comp3_rr, nstudies = 2, 
                    int = "RLDRH", comp = "ODRH",
                    outcome = 'Complications I-II')


plot <- plotrr_single_studies(words = tcomp3$b,
                      numbers = tcomp3$c,
                      fpPosition = ncol(tcomp3$b),
                      xtick = c(0.12,0.25,0.5,1,2,4,8),
                      sizes = c(rep(NA,3), 0.008*(comp3_rr$pre$weights+50), NA, 1, NA),
                      bolding = c(T, rep(F, 6), T, F),
                      aligning = c('l', rep('c', 2), 'l', 'l'))
```


</details>



### Figure 19
<details><summary><b>Show figure</b> - Risk of postoperative complications Clevien-Dindo III-IV at 30 days after RLDRH versus ODRH</summary>

```{r ODRH_complication2, fig.height=3, fig.width=15, echo=FALSE, message=FALSE, warning=FALSE}
comp4 <- subset(compODRH, definition=='III-IV')

comp4_rr <- rr(comp4)

tcomp4 <- table_rr(analysis = comp4_rr, nstudies = 2, 
                    int = "RLDRH", comp = "ODRH",
                    outcome = 'Complications III-IV')


plot <- plotrr_single_studies(words = tcomp4$b,
                      numbers = tcomp4$c,
                      fpPosition = ncol(tcomp4$b),
                      xtick = c(0.06,0.25,1,4,16),
                      sizes = c(rep(NA,3), 0.008*(comp4_rr$pre$weights+50), NA, 1, NA),
                      bolding = c(T, rep(F, 6), T, F),
                      aligning = c('l', rep('c', 2), 'l', 'l'))
```
</details>


## Summary of forest plots - *Recipient Patients*

```{r cleaning_continuous_recipient, echo=FALSE, message=FALSE, warning=FALSE}
e <- read.csv("6 Extracted Data/outcome_continuous_recipient.csv")
e <- e[c(1:9),]
e2 <- e[!is.na(e$comparison),]

names(e2)[10] <- 'n1'
names(e2)[11] <- 'n2'
names(e2)[12] <- 'mean_post1'
names(e2)[13] <- 'sd_post1'
names(e2)[14] <- 'mean_post2'
names(e2)[15] <- 'sd_post2'

e2$outcome[e2$outcome == 'Peak ASL level'] <- 'Peak ALT level'


e2[,c(12:15)] <- lapply(e2[,c(12:15)], as.numeric)


e2$author <- 
  ifelse(e2$refid==9, paste("Rho et al., 2020"),
  ifelse(e2$refid==27, paste("Broering et al., 2020"),
  ifelse(e2$refid==5, paste("Binoj et al., 2020"),
  ifelse(e2$refid==172, paste("Chen et al., 2016"),
  ifelse(e2$refid==74, paste("Cheah et al., 2019"),
  ifelse(e2$refid==239, paste("Martucci et al., 2013"),
  ifelse(e2$refid==277, paste("Giulianotti et al., 2011"), NA)))))))
```


</details>



### Figure 20
<details><summary><b>Show figure</b> - Difference in mean length of hospital stay (days) after RLDRH versus LADRH</summary>

```{r hospitalstay_LADRH_recipient, fig.height=3, fig.width=13, echo=FALSE, message=FALSE, warning=FALSE}
hospital3 <- subset(e2, comparison=='LADRH')

hospital3_md <- md(hospital3)

thospital3 <- table_md(analysis = hospital3_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Length of stay (days)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = thospital3$b,
                      numbers = thospital3$c,
                      fpPosition = ncol(thospital3$b),
                      xtick = c(-20, -10, -5, 0, 5, 10, 20),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
```

</details>



### Figure 21
<details><summary><b>Show figure</b> - Difference in mean length of hospital stay (days) after RLDRH versus ODRH</summary>

```{r hospitalstay_ODRH_recipient, fig.height=3, fig.width=16, echo=FALSE, message=FALSE, warning=FALSE}
hospital4 <- subset(e2, comparison=='ODRH' & outcome=='Hospital stay')

hospital4_md <- md(hospital4)

thospital4 <- table_md(analysis = hospital4_md, nstudies = 3, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Length of stay (days)', col = 'Mean (SD)')

plot <- plotmd_single_studies(words = thospital4$b,
                      numbers = thospital4$c,
                      fpPosition = ncol(thospital4$b)-1,
                      xtick = c(-20, -10, -5, 0, 5, 10, 20),
                      sizes = c(rep(NA,3), 0.005*(hospital4_md$pre$weights+50), NA, 1,NA),
                      bolding = c(T, rep(F, 5), T, F),
                      aligning = c('l', rep('c', 4), 'l', 'l'))
```


</details>


### Figure 22
<details><summary><b>Show figure</b> - Difference in mean blood loss (mL) after RLDRH versus ODRH</summary>

```{r blood_ODRH_recipient, fig.height=3, fig.width=13, echo=FALSE, message=FALSE, warning=FALSE}
blood3 <- subset(e2, comparison=='ODRH' & outcome=='Estimated blood loss')

blood3_md <- md(blood3)

tblood3 <- table_md(analysis = blood3_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Blood loss (mL)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tblood3$b,
                      numbers = tblood3$c,
                      fpPosition = ncol(tblood3$b),
                      xtick = c(-1500, -500, 0, 500, 1500, 2500),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
```

</details>


### Figure 23
<details><summary><b>Show figure</b> - Difference in mean AST peak levels (U/L) afterRLDRH versus ODRH</summary>

```{r ast_ODRH_recipient, fig.height=3, fig.width=13, echo=FALSE, message=FALSE, warning=FALSE}
ast3 <- subset(e2, comparison=='ODRH' & outcome=='Peak AST level')

ast3_md <- md(ast3)

tast3 <- table_md(analysis = ast3_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'AST (U/L)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tast3$b,
                      numbers = tast3$c,
                      fpPosition = ncol(tast3$b),
                      xtick = c(-2,-1,0,1,2),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
```

</details>


### Figure 24
<details><summary><b>Show figure</b> - Difference in mean ALT peak levels (IU/L) after RLDRH versus ODRH</summary>

```{r alt_ODRH_recipient, fig.height=3, fig.width=13, echo=FALSE, message=FALSE, warning=FALSE}
alt3 <- subset(e2, comparison=='ODRH' & outcome=='Peak ALT level')

alt3_md <- md(alt3)

talt3 <- table_md(analysis = alt3_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'ALT (IU/L)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = talt3$b,
                      numbers = talt3$c,
                      fpPosition = ncol(talt3$b),
                      xtick = c(-50,-30,  -10, 0, 10, 30,  50),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
```

</details>


### Figure 25
<details><summary><b>Show figure</b> - Difference in mean peak total bilirubin levels after RLDRH versus ODRH</summary>

```{r bilirubin_ODRH_recipient, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
bil3 <- subset(e2, comparison=='ODRH' & outcome=='Peak Total Bilirubin')

bil3_md <- md(bil3)

tbil3 <- table_md(analysis = bil3_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Peak Total Bilirubin (mg/dL)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tbil3$b,
                      numbers = tbil3$c,
                      fpPosition = ncol(tbil3$b),
                      xtick = c(-2,-1, 0, 1,2),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
```


```{r cleaning_dichotomous_recipient, echo=FALSE, message=FALSE, warning=FALSE}
f <- read.csv("6 Extracted Data/outcome_dichotomous_recipient.csv")
f$outcomes2 <- ifelse(is.na(f$definition), paste0(f$outcomes), paste(f$outcomes, f$definition))
f$comparison[f$comparison == 'NR'] <- NA

f2 <- f[!is.na(f$comparison),]

names(f2)[10] <- "n1"
names(f2)[11] <- "n2"
names(f2)[12] <- "e1"
names(f2)[13] <- "e2"

f2$comparison[f2$comparison == 'ORLDH'] <- 'ODRH'

f2[,c(10:13)] <- lapply(f2[,c(10:13)], as.numeric)


f2$author <- 
  ifelse(f2$refid==9, paste("Rho et al., 2020"),
  ifelse(f2$refid==27, paste("Broering et al., 2020"),
  ifelse(f2$refid==5, paste("Binoj et al., 2020"),
  ifelse(f2$refid==172, paste("Chen et al., 2016"),
  ifelse(f2$refid==74, paste("Cheah et al., 2019"),
  ifelse(f2$refid==239, paste("Martucci et al., 2013"),
  ifelse(f2$refid==277, paste("Giulianotti et al., 2011"), NA)))))))

f2LADRH <- subset(f2, comparison=='LADRH')
f2ODRH <- subset(f2, comparison=='ODRH')
```


</details>


### Figure 26
<details><summary><b>Show figure</b> - Mortality risk at 30 days after RLDRH versus LADRH</summary>

```{r mortality_LADRH,  fig.height=3, fig.width=13, echo=FALSE, message=FALSE, warning=FALSE}
mortality1 <- subset(f2LADRH, outcomes=='Mortality')

mortality1_rr <- rr(mortality1)

tmortality1 <- table_rr(analysis = mortality1_rr, nstudies = 1, 
                    int = "RLDRH", comp = "LADRH",
                    outcome = 'Mortality')


plot <- plotrr_single_studies(words = tmortality1$b,
                      numbers = tmortality1$c,
                      fpPosition = ncol(tmortality1$b),
                      xtick = c(0.06, 0.25,0.5,1,2,4, 16, 64),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 2), 'l'))
```


</details>



### Figure 27
<details><summary><b>Show figure</b> - Mortality risk at 30 days after RLDRH versus ODRH</summary>

```{r mortality_ODRH_recipient,  fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
mortality2 <- subset(f2ODRH, outcomes=='Mortality')

mortality2_rr <- rr(mortality2)

tmortality2 <- table_rr(analysis = mortality2_rr, nstudies = 3, 
                    int = "RLDRH", comp = "ODRH",
                    outcome = 'Mortality')


plot <- plotrr_single_studies(words = tmortality2$b,
                      numbers = tmortality2$c,
                      fpPosition = ncol(tmortality2$b),
                      xtick = c( 0.06,0.25,0.5,1,2,4, 16),
                      sizes = c(rep(NA,3), 0.005*(mortality2_rr$pre$weights+50),NA, 1, NA),
                      bolding = c(T, rep(F, 6), T, F),
                      aligning = c('l', rep('c', 2), 'l', 'l'))
```
</details>


### Figure 28
<details><summary><b>Show figure</b> - Risk of postoperative complications Clevien-Dindo I-II at 30 days after RLDRH versus LADRH</summary>

```{r complciationsI_LADRH_recipient,  fig.height=3, fig.width=13, echo=FALSE, message=FALSE, warning=FALSE}
complications3 <- subset(f2LADRH, outcomes2=='Postoperative complications I-II')

complications3_rr <- rr(complications3)

tcomplications3 <- table_rr(analysis = complications3_rr, nstudies = 1, 
                    int = "RLDRH", comp = "LADRH",
                    outcome = 'Complications')


plot <- plotrr_single_studies(words = tcomplications3$b,
                      numbers = tcomplications3$c,
                      fpPosition = ncol(tcomplications3$b),
                      xtick = c( 0.25,0.5,1,2,4),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 2), 'l'))
```


</details>


### Figure 29
<details><summary><b>Show figure</b> - Risk of postoperative complications Clevien-Dindo I-II at 30 days after RLDRH versus ODRH</summary>

```{r complicationsI_ODRH_recipient,  fig.height=3, fig.width=15, echo=FALSE, message=FALSE, warning=FALSE}
complications4 <- subset(f2ODRH, outcomes2=='Postoperative complications I-II')

complications4_rr <- rr(complications4)

tcomplications4 <- table_rr(analysis = complications4_rr, nstudies = 3, 
                    int = "RLDRH", comp = "ODRH",
                    outcome = 'Complications I-II')


plot <- plotrr_single_studies(words = tcomplications4$b,
                      numbers = tcomplications4$c,
                      fpPosition = ncol(tcomplications4$b),
                      xtick = c( 0.12,0.25,0.5,1,2,4, 8),
                      sizes = c(rep(NA,3), 0.005*(complications4_rr$pre$weights+50), NA, 1, NA),
                      bolding = c(T, rep(F, 6), T, F),
                      aligning = c('l', rep('c', 2), 'l', 'l'))
```
</details>



### Figure 30
<details><summary><b>Show figure</b> - Risk of postoperative complications Clevien-Dindo III-IV at 30 days after RLDRH versus LADRH</summary>


```{r complicationsIII_LADRH_recipient,  fig.height=3, fig.width=13, echo=FALSE, message=FALSE, warning=FALSE}
complications4 <- subset(f2LADRH, outcomes2=='Postoperative complications III-IV')

complications4_rr <- rr(complications4)

tcomplications4 <- table_rr(analysis = complications4_rr, nstudies = 1, 
                    int = "RLDRH", comp = "LADRH",
                    outcome = 'Complications III-IV')


plot <- plotrr_single_studies(words = tcomplications4$b,
                      numbers = tcomplications4$c,
                      fpPosition = ncol(tcomplications4$b),
                      xtick = c( 0.25,0.5,1,2,4),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 2), 'l'))
```


</details>



### Figure 31
<details><summary><b>Show figure</b> - Risk of postoperative complications Clevien-Dindo III-IV at 30 days after RLDRH versus ODRH</summary>

```{r complicationsIII_ODRH_recipient,  fig.height=3, fig.width=15, echo=FALSE, message=FALSE, warning=FALSE}
complications5 <- subset(f2ODRH, outcomes2=='Postoperative complications III-IV')

complications5_rr <- rr(complications5)

tcomplications5 <- table_rr(analysis = complications5_rr, nstudies = 3, 
                    int = "RLDRH", comp = "ODRH",
                    outcome = 'Complications III-IV')


plot <- plotrr_single_studies(words = tcomplications5$b,
                      numbers = tcomplications5$c,
                      fpPosition = ncol(tcomplications5$b),
                      xtick = c( 0.12,0.25,0.5,1,2,4, 8),
                      sizes = c(rep(NA,3), 0.005*(complications5_rr$pre$weights+50), NA, 1, NA),
                      bolding = c(T, rep(F, 6), T, F),
                      aligning = c('l', rep('c', 2), 'l', 'l'))
```

</details>
