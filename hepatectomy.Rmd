---
title: "Hepatectomy"
author: "Oscar J. Ponce & Eddy Lincango"
date: "18/11/2020"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(dpi=900)
knitr::opts_chunk$set(dev='svg')

library(webshot)
library(metafor)
library(tidyverse)
library(rmarkdown)
library(magrittr)
library(grid)
library(gt)
library(forestplot)
library(glue)
library(Gmisc)
library(Matrix)

```


```{r cleaning_continuous_donor, echo=FALSE, message=FALSE, warning=FALSE}
#continuous donor
h <- read.csv("6 Extracted Data/outcome_continuous_donor.csv")


h1<-h[!(h$analysis=='no'),]

names(h1)[6] <- "outcome"
names(h1)[8] <- "followup"
names(h1)[11] <- 'n1'
names(h1)[12] <- 'n2'
names(h1)[13] <- 'mean_post1'
names(h1)[14] <- 'sd_post1'
names(h1)[15] <- 'mean_post2'
names(h1)[16] <- 'sd_post2'

h1[11:16] <- sapply(h1[11:16],as.numeric)

h1$outcome[h1$outcome == 'Estimated blodd loss'] <- 'blood loss'
h1$outcome[h1$outcome == 'Estimated blood loss'] <- 'blood loss'

h1$intervention[h1$intervention == 'RlDRH'] <- 'RLDRH'

h1$author <- 
  ifelse(h1$refid==9, paste("Rho et al., 2020"),
  ifelse(h1$refid==27, paste("Broering et al., 2020"),
  ifelse(h1$refid==5, paste("Binoj et al., 2020"),
  ifelse(h1$refid==172, paste("Chen et al., 2016"),
  ifelse(h1$refid==74, paste("Cheah et al., 2019"),
  ifelse(h1$refid==239, paste("Martucci et al., 2013"),
  ifelse(h1$refid==277, paste("Giulianotti et al., 2011"), NA)))))))

#h1[h1$outcome == 'Liver funcion', c(1:3,5,6,7,11:16)]

```


```{r functions_md_rr, echo=FALSE, message=FALSE, warning=FALSE}
md <- function(database){
  
  db <- database
  db <- escalc(measure="MD", 
               m1i=mean_post1, m2i = mean_post2, 
               sd1i  = sd_post1, sd2i = sd_post2, 
               n1i = n1, n2i= n2, data=database)
  db$vi <- ifelse(is.na(db$vi), 
               ((db$mdul_post-db$mdll_post)/((2*abs(qt(0.05/2, db$total-1)))^2)), db$vi)
  db <- db[order(db$yi),]
  db <- summary(db)
  
  db$md <- paste(formatC(db$yi, format='f', digits =1)," ",
                 "(",formatC(db$ci.lb, format='f', digits =1),
                 ",",formatC(db$ci.ub, format='f', digits=1),")") 
  db$postmean1 <- paste(formatC(db$mean_post1, format='f', digits=1),'(', formatC(db$sd_post1, format='f', digits=1),')')
  db$postmean2 <- paste(formatC(db$mean_post2, format='f', digits=1),'(', formatC(db$sd_post2, format='f', digits=1),')')
  
  ma <- rma(yi, vi, measure='MD', data=db, method='REML')
  
  db$w <- paste(formatC(weights(ma), format='f', digits = 1),'%')
  db$weights <- weights(ma)
  
  list(pre = db, ma = ma)
}


table_md <- function(analysis, nstudies, int, comp, outcome, col, 
                     follow=FALSE){
   ifelse(nstudies>1,
        (b <- cbind( 
          c("Author", analysis$pre$author, 
            paste("Overall Mean Difference for", analysis$ma$k, "studies","\n", 
                  "(Tau^2 = ", (formatC(analysis$ma$tau2, digits=2, format="f")), ", df = ", 
                  (analysis$ma$k - analysis$ma$p),
                  ", p ", (ifelse(analysis$ma$QEp < 0.001, 
                                  paste("< 0.001"),
                                  paste("= ", formatC(analysis$ma$QEp, digits=3, format="f")))),
                  "; ", "I^2", " = ", (formatC(analysis$ma$I2, digits=1, format="f")), "%)")),
        c(paste(int), analysis$pre$n1, sum(analysis$pre$n1)),
        c(paste(outcome, '\n', col), analysis$pre$postmean1, NA),
        c(paste(comp), analysis$pre$n2,sum(analysis$pre$n2)),
        c(paste(outcome, '\n', col), analysis$pre$postmean2, NA),
        c("Mean Difference (95% CI)", analysis$pre$md, 
            paste(formatC(analysis$ma$b, format='f', digits =1), 
                  " (",formatC(analysis$ma$ci.lb, format='f', digits=1),
                  ",", formatC(analysis$ma$ci.ub, format='f', digits=1), ")")),
        c("Weight (%)", analysis$pre$w, NA))),
        (b <- cbind( 
        c("Author", analysis$pre$author),
        c(paste(int), analysis$pre$n1),
        c(paste(outcome,'\n', col), analysis$pre$postmean1),
        c(paste(comp), analysis$pre$n2),
        c(paste(outcome, '\n',col), analysis$pre$postmean2),
        c("Mean Difference (95% CI)", analysis$pre$md))))

  ifelse(follow==TRUE, 
          b <- cbind(b, c(paste('Follow-up'), analysis$followup, NA)), NA)
  ifelse(follow==TRUE,
          b <- b[,c(1:5,ncol(b),ncol(b)-2, ncol(b)-1)], NA)
  
  
  b <- as_tibble(b) 
  b <- b %>% add_row(.before = 2)
  b <- b %>% add_row(.before = 2)
  b <- b %>% add_row(.after = nrow(b))
  
  ifelse(nstudies>1, b <- b %>% add_row(.before = nrow(b)-1), NA)

  
  ifelse(nstudies > 1,
        (c <- structure(list(
          mean = c(rep(NA, 3), analysis$pre$yi, NA, analysis$ma$b,NA),
          lower = c(rep(NA, 3), analysis$pre$ci.lb, NA, analysis$ma$ci.lb, NA),
          upper = c(rep(NA, 3), analysis$pre$ci.ub, NA, analysis$ma$ci.ub, NA)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, -1L*nrow(b)),
          class = "data.frame")),
        (c <- structure(list(
          mean = c(rep(NA, 3), analysis$pre$yi, NA),
          lower = c(rep(NA, 3), analysis$pre$ci.lb, NA),
          upper = c(rep(NA, 3), analysis$pre$ci.ub, NA)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, -1L*nrow(b)),
          class = "data.frame")))

  c <- as_tibble(c)
  
  list(b = b, c = c)
} 




plotmd_single_studies <- function(words, numbers,  
                                  xtick, sizes, bolding, aligning, fpPosition) {

  (forestplot(words,
             graph.pos = fpPosition,
             zero = 0,
             numbers,
             new_page = TRUE,
             colgap = unit(5, "mm"),
             hrzl_lines = list('3' = gpar (lwd=1, columns=c(1:(ncol(words)+1)), col="black")),
             lineheight=unit(0.7,'cm'),
             boxsize = sizes,
             line.margin = 2,
             is.summary = bolding,
             align = aligning,
             ci.vertices = TRUE,
             txt_gp = fpTxtGp(label =gpar (cex=0.9), 
                              ticks = gpar(cex = 0.9, fontface="bold"),
                              summary = gpar(cex = 0.9),
                              xlab = gpar(cex=0.9)),
             xticks = xtick,
             xlog=FALSE,
             clip = c(0,1),
             grid = xtick,
             lwd.xaxis = 1,
             lwd.ci = 2.2,
             lwd.zero = 1.5,
             graphwidth = unit(10,"cm"),
             col=fpColors(box="black",line="grey", zero = 'dodgerblue4', axes="grey20", summary="black")))
 
}








rr <- function(database){
  db <- database
  db <- escalc(measure="RR", ai=e1, ci=e2, n1i=n1, n2i=n2,data=database)
  db <- db[order(db$yi),]
  db <- summary(db)
  
  db$est <-  exp(db$yi)
  db$ci.lb <- exp(db$ci.lb)
  db$ci.ub <- exp(db$ci.ub)
  
  
  db$rate1 <- paste(db$e1,"/",db$n1)
  db$rate2 <- paste(db$e2,"/",db$n2)
  db$rr <- paste(formatC(db$est, format='f', digits =2)," ",
                 "(",formatC(db$ci.lb, format='f', digits =2),
                 "-",formatC(db$ci.ub, format='f', digits=2),")")  
  
  ma <- rma(db$yi, db$vi, measure='RR', data=db, method='REML')
  exp <- predict(ma, transf = transf.exp.int)
  
  db$weights <- weights(ma)
  db$w <- paste(formatC(db$weights, format='f', digits = 1),'%')
  
  
  list(pre = db, ma = ma, exp = exp)
}



table_rr <- function(analysis, int, comp, outcome, nstudies){
  ifelse(nstudies>1,
  b <- cbind( 
    c("Author", analysis$pre$author, 
      paste("Overall Relative Risk for", analysis$ma$k, "studies","\n", 
            "(Tau^2 = ", (formatC(analysis$ma$tau2, digits=2, format="f")), ", df = ", 
            (analysis$ma$k - analysis$ma$p),
            ", p ", (ifelse(analysis$ma$QEp < 0.001, 
                            paste("< 0.001"),
                            paste("= ", formatC(analysis$ma$QEp, digits=3, format="f")))),
            "; ", "I^2", " = ", (formatC(analysis$ma$I2, digits=1, format="f")), "%)")),
    c(paste(int, '\n', outcome,'/','total n'),analysis$pre$rate1, paste(sum(analysis$pre$e1), " / ",
                                                      sum(analysis$pre$n1))),
    c(paste(comp, '\n', outcome,'/', 'total n'),analysis$pre$rate2, paste(sum(analysis$pre$e2), " / ",
                                                        sum(analysis$pre$n2))),
    c("Relative Risk (95% CI)", analysis$pre$rr, 
      paste(formatC(analysis$exp$pred, format='f', digits =2), 
            " (",formatC(analysis$exp$ci.lb, format='f', digits=2),
            "-", formatC(analysis$exp$ci.ub, format='f', digits=2), ")")),
    c("Weight(%)", paste(formatC(weights(analysis$ma), format='f', digits = 1),'%'), NA)),
       b <- cbind( 
        c("Author", analysis$pre$author),
        c(paste(int, '\n', outcome,'/','total n'),analysis$pre$rate1),
        c(paste(comp, '\n', outcome,'/', 'total n'),analysis$pre$rate2),
        c("Relative Risk (95% CI)", analysis$pre$rr)))
  
  b <- as_tibble(b, .name_repair = "unique")
  b <- b %>% add_row(.before = 2)
  b <- b %>% add_row(.before = 2)
  b <- b %>% add_row(.after = nrow(b))  
  
  ifelse(nstudies>1, b <- b %>% add_row(.before = nrow(b)-1), NA)

  
  ifelse(nstudies > 1,
        (c <- structure(list(
          mean = c(rep(NA, 3), analysis$pre$est, NA, analysis$exp$pred,NA),
          lower = c(rep(NA, 3), analysis$pre$ci.lb, NA, analysis$exp$ci.lb, NA),
          upper = c(rep(NA, 3), analysis$pre$ci.ub, NA, analysis$exp$ci.ub, NA)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, -1L*nrow(b)),
          class = "data.frame")),
        (c <- structure(list(
          mean = c(rep(NA, 3), analysis$pre$est, NA),
          lower = c(rep(NA, 3), analysis$pre$ci.lb, NA),
          upper = c(rep(NA, 3), analysis$pre$ci.ub, NA)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, -1L*nrow(b)),
          class = "data.frame")))

  c <- as_tibble(c)
  
  list(b = b, c = c)
} 
  
  
  




plotrr_single_studies <- function(words, numbers, xtick, sizes, 
                                  bolding, aligning, fpPosition){
  
  forestplot(words,
             graph.pos = fpPosition,
             zero = 1,
             numbers,
             new_page = TRUE,
             colgap = unit(5, "mm"),
             hrzl_lines = list("3" = gpar (lwd=1, columns=c(1:(ncol(words)+1)), col="black")),
             lineheight=unit(0.7,'cm'),
             boxsize = sizes,
             line.margin = 2,
             is.summary = bolding,
             align = aligning,
             ci.vertices = TRUE,
             txt_gp = fpTxtGp(label =gpar (cex=0.9), 
                              ticks = gpar(cex = 0.9, fontface="bold"),
                              summary = gpar(cex = 0.9),
                              xlab = gpar(cex=0.9)),
             xticks = xtick,
             xlog=TRUE,
             clip = c(0.2, 32),
             grid = xtick,
             lwd.xaxis = 1,
             lwd.ci = 2.2,
             lwd.zero = 2,
             graphwidth = unit(10,"cm"),
             col=fpColors(box="black",line="grey", zero = 'dodgerblue4', axes="grey20", summary="black"))
  
  
}  


```



## Summary of forest plots - *Donors Patients*


### Figure 2 
<details><summary> <b>Show figure</b> - Differences in blood loss (mL) after RLDRH vs LADRH</summary> 

```{r blood_loss_1, fig.height=3, fig.width=13, echo=FALSE, message=FALSE, warning=FALSE}
blood <- subset(h1, outcome=='blood loss')
blood1 <- subset(blood, comparison=='LADRH')

blood1_md <- md(blood1)

tblood1 <- table_md(analysis = blood1_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Blood loss (mL)', col = 'Mean (SD)',
                    follow = FALSE)

plot <- plotmd_single_studies(words = tblood1$b,
                      numbers = tblood1$c,
                      fpPosition = ncol(tblood1$b),
                      xtick = c(-250, -150, -50,0, 50, 150), 
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, F, F,T,F),
                      aligning = c('l',rep('c',4),'l'))
```

</details>



### Figure 3
<details><summary><b>Show figure</b> - Differences in blood loss (mL) after RLDRH vs ODRH </summary>

```{r blood_loss2, fig.height = 3, fig.width = 16, echo=FALSE, fig.retina = 2, message=FALSE, warning=FALSE}
blood2 <- subset(blood, comparison=='ODRH')

blood2_md <- md(blood2)

tblood2 <- table_md(analysis = blood2_md, nstudies = 4, 
                    int = "ODRH (n)", comp = "LADRH (n)",
                    outcome = 'Blood Loss (mL)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tblood2$b,
                      numbers = tblood2$c,
                      fpPosition = ncol(tblood2$b)-1,
                      xtick = c(-250, -150, -50, 0, 50, 150, 250), 
                      sizes = c(rep(NA,3), 0.011*(blood2_md$pre$weights+50), NA, 1,NA),
                      bolding = c(T, rep(F, 7), T, F),
                      aligning = c('l', rep('c', 4), 'l', 'l'))

```

</details>



### Figure 4
<details><summary><b>Show figure</b> - Differences in length of hospital stay (days) after RLDRH vs LADRH</summary>

```{r hospital1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
hospital <- subset(h1, outcome=='Hospital stay')
hospital1 <- subset(hospital, comparison=='LADRH')

hospital1_md <- md(hospital1)

thospital1 <- table_md(analysis = hospital1_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Length of stay (days)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = thospital1$b,
                      numbers = thospital1$c,
                      fpPosition = ncol(thospital1$b),
                      xtick = c(-2, -1,  0,  1, 2),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
  

```
</details>



### Figure 5
<details><summary><b>Show figure</b> - Differences in length of hospital stay (days) after RLDRH vs ODRH</summary>

```{r hospital2, fig.height=3, fig.width=16, echo=FALSE, message=FALSE, warning=FALSE}
hospital2 <- subset(hospital, comparison=='ODRH')

hospital2_md <- md(hospital2)

thospital2 <- table_md(analysis = hospital2_md, nstudies = 3, 
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Length of stay (days)', col = 'Mean (SD)')



plot <- plotmd_single_studies(words = thospital2$b,
                      numbers = thospital2$c,
                      fpPosition = ncol(thospital2$b)-1,
                      xtick = c(-3, -2, -1, -0.5, 0, 0.5, 1, 2),
                      sizes = c(rep(NA,3), 0.011*(hospital2_md$pre$weights+50), NA, 1,NA),
                      bolding = c(T, rep(F, 7), T, F),
                      aligning = c('l', rep('c', 4), 'l', 'l'))

```
</details>



### Figure 6
<details><summary><b>Show figure</b> - Differences in pain (VAS) after RLDRH vs LADRH</summary>

```{r pain1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
pain <- subset(h1, outcome=='Pain score')

pain1 <- subset(pain, comparison=='LADRH')

pain2 <- NULL
pain2_md <- NULL

for (i in 1:length(pain1$followup)){
  pain2[[i]] <- subset(pain1, followup==followup[i])
  pain2_md[[i]] <- md(pain2[[i]])
}

tpain2 <- NULL
for (i in 1:length(pain2_md)){
  tpain2[[i]] <- table_md(analysis = pain2_md[[i]][1], nstudies=1,
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Pain score', col = 'Mean (SD)')
}

b <- rbind(tpain2[[1]]$b[c(1,4),],
           tpain2[[2]]$b[c(4),],
           tpain2[[3]]$b[c(4),])
b[7] <- c('Follow-up', pain1$followup)
b <- b[,c(1,7,2:6)]
b <- b %>% add_row(.before = 2)
b <- b %>% add_row(.before = 2)
b <- b %>% add_row(.before = 5)
b <- b %>% add_row(.before = 7)
b <- b %>% add_row(.before = 9)



c <- rbind(tpain2[[1]]$c[4,],
           tpain2[[2]]$c[4,],
           tpain2[[3]]$c[4,])
c <- c %>% add_row(.before = 1)
c <- c %>% add_row(.before = 1)
c <- c %>% add_row(.before = 1)
c <- c %>% add_row(.before = 5)
c <- c %>% add_row(.before = 7)
c <- c %>% add_row(.before = 9)

c <- structure(list(
          mean = c(c$mean),
          lower = c(c$lower),
          upper = c(c$upper)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, (-1L*nrow(c))),
          class = "data.frame")

plot <- plotmd_single_studies(words = b, 
                              numbers = c, 
                              fpPosition = ncol(b),
                      xtick = c(-2, -1, -0.5, 0, 0.5, 1, 2),
                      sizes = c(rep(NA,3), rep(c(1,NA),3)),
                      bolding = c(T, F, F, rep(c(T, F), 3)),
                      aligning = c('l', rep('c', 3), 'l', 'l'))

```


```{r pain2_analysis, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
pain2 <- subset(pain, comparison=='ODRH')


pain3 <- NULL
pain3_md <- NULL
for (i in 1:length(unique(pain2$followup))){
  pain3 [[i]] <- subset(pain2, followup==followup[i])
  pain3_md[[i]] <- md(pain3[[i]])
}

tpain3 <- NULL
for (i in 1:length(pain3_md)){
  tpain3[[i]] <- table_md(analysis = pain3_md[[i]], nstudies=3,
                    int = "RLDRH (n)", comp = "ODRH (n)",
                    outcome = 'Pain score', col = 'Mean (SD)')
}

```


</details>



### Figure 7

<details><summary><b>Show figure</b> - Differences in pain (VAS) after RLDRH vs ODRH</summary>

```{r pain2_followups, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
b <- NULL
for (i in 1:length(pain3_md)) {

b[[i]] <- cbind(unique(pain3_md[[i]]$pre$followup),
                pain3_md[[i]]$ma$k,
                sum(pain3_md[[i]]$pre$n1),
                sum(pain3_md[[i]]$pre$n2),
                paste(formatC(pain3_md[[i]]$ma$I2, format='f', digits=0),"%"))
}


b <- rbind (c('Follow-up', paste('Number', '\n', 'of studies'), 'Intervention (n)', 'Comparison (n)', 'I2'), 
            b[[1]], 
            b[[2]], 
            b[[3]])

b <- cbind(b, 
           c('Mean Difference (95% CI)', tpain3[[1]]$b[8,6], tpain3[[2]]$b[7,6],tpain3[[3]]$b[7,6]))
b <- (b[,c(1:4,6,5)])

b <- data.frame(matrix(unlist(b), nrow=4, byrow=F))

b <- b %>% add_row( .before = 2)
b <- b %>% add_row( .before = 7)
b <- b %>% add_row( .before = 2)

b <- b %>% add_row( .before = 5)
b <- b %>% add_row( .before = 7)


c <- rbind(tpain3[[1]]$c[8,], tpain3[[2]]$c[7,],tpain3[[3]]$c[7,])
c <- structure(list(
          mean = c(c$mean),
          lower = c(c$lower),
          upper = c(c$upper)),
          .Names = c("mean", "lower", "upper"),
          row.names = c(NA, (-1L*nrow(c))),
          class = "data.frame")
c <- c %>% add_row( .before = 1)
c <- c %>% add_row( .before = 1)
c <- c %>% add_row( .before = 1)
c <- c %>% add_row( .before = 7)


c <- c %>% add_row( .before = 5)
c <- c %>% add_row( .before = 7)

plot <- plotmd_single_studies(words = b,
                      numbers = c,
                      fpPosition = ncol(b)-1,
                      xtick = c(-2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2),
                      sizes = c(rep(NA,3), rep(c(0.8, NA), 3)),
                      bolding = c(T, rep(F, 2), rep(c(T,F),3)),
                      aligning = c('l', rep('c', 3), 'l', 'l'))


```

> To generate this forest plot, we used information from Supplementary Figures 1 to 3.

</details>

</br>

> **Show supplementary figures used to generate Figure 7**

  + <details><summary> Supp Fig 1: RLDRH vs ODRH - Pain (VAS) at day 0-1 </summary>
  <p>
```{r pain2_followup1, fig.height=3, fig.width=15, echo=FALSE, message=FALSE, warning=FALSE}

plot <- plotmd_single_studies(words = tpain3[[1]]$b, 
                              numbers = tpain3[[1]]$c, 
                              fpPosition = ncol(tpain3[[1]]$b)-1,
                              xtick =  c(-2, -1, 0, 1, 2),
                              sizes = c(rep(NA,3), 0.011*(pain3_md[[1]]$pre$weights),NA, 1, NA),
                              bolding = c(T, rep(F,2), rep(F, 3), F, T, F),
                              aligning = c('l', rep('c', 4), 'l', 'l'))

```
  </p>
  </details>
  + <details><summary> Supp Fig 2: RLDRH vs ODRH - Pain (VAS) at day 2-3 </summary>
  <p>
```{r pain2_followup2, fig.height=3, fig.width=15, echo=FALSE, message=FALSE, warning=FALSE}
plot <- plotmd_single_studies(words = tpain3[[2]]$b, 
                              numbers = tpain3[[2]]$c, 
                              fpPosition = ncol(tpain3[[2]]$b)-1,
                              xtick =  c(-2, -1, 0, 1, 2),
                              sizes = c(rep(NA,3), 0.011*(pain3_md[[2]]$pre$weights),NA, 1, NA),
                              bolding = c(T, rep(F,2), rep(F, 2), F, T, F),
                              aligning = c('l', rep('c', 4), 'l', 'l'))

```
  </p>
  </details>
  + <details><summary> Supp Fig 3: RLDRH vs ODRH - Pain (VAS) at day greater than 3 </summary>
  <p>
```{r pain2_followup3, fig.height=3, fig.width=15, echo=FALSE, message=FALSE, warning=FALSE}
plot <- plotmd_single_studies(words = tpain3[[3]]$b, 
                              numbers = tpain3[[3]]$c, 
                              fpPosition = ncol(tpain3[[3]]$b)-1,
                              xtick =  c(-2, -1, 0, 1, 2),
                              sizes = c(rep(NA,3), 0.011*(pain3_md[[2]]$pre$weights),NA, 1, NA),
                              bolding = c(T, rep(F,2), rep(F, 2), F, T, F),
                              aligning = c('l', rep('c', 4), 'l', 'l'))

```
  </p>
  </details>

<br />


### Figure 8
<details><summary><b>Show figure</b> - Differences in peak ALT level (IU/L) after RLDRH vs LADRH</summary>

```{r alt1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
alt <- subset(h1, outcome=='Peak ALT level')

alt1 <- subset(alt, comparison=='LADRH')


alt1_md <- md(alt1)

talt1 <- table_md(analysis = alt1_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Peak ALT Level (IU/L)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = talt1$b,
                      numbers = talt1$c,
                      fpPosition = ncol(talt1$b),
                      xtick = c(-50, 0, 50, 150),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))

```

</details>



### Figure 9
<details><summary><b>Show figure</b> - Differences in peak ALT level (IU/L) after RLDRH vs ODRH</summary>

```{r alt2, fig.height=3, fig.width=16, echo=FALSE, message=FALSE, warning=FALSE}
alt2 <- subset(alt, comparison=='ODRH')


alt2_md <- md(alt2)

talt2 <- table_md(analysis = alt2_md, nstudies = 3, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Peak ALT Level (IU/L)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = talt2$b,
                      numbers = talt2$c,
                      fpPosition = ncol(talt2$b)-1,
                      xtick = c(-250, -150,-50, 0, 50, 150, 250),
                      sizes = c(rep(NA,3), 0.02*(alt2_md$pre$weights),NA, 1, NA),
                      bolding = c(T, rep(F, 6), T, F),
                      aligning = c('l', rep('c', 4), 'l', 'l'))

```


</details>



### Figure 10
<details><summary><b>Show figure</b> - Differences in peak AST level (IU/L) after RLDRH vs LADRH</summary>

```{r ast1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
ast <- subset(h1, outcome=='Peak AST level')
ast1 <- subset(ast, comparison=='LADRH')

ast1_md <- md(ast1)

tast1 <- table_md(analysis = ast1_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Peak AST Level (IU/L)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tast1$b,
                      numbers = tast1$c,
                      fpPosition = ncol(tast1$b),
                      xtick = c(-50, 0, 50, 150),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
```


</details>



### Figure 11
<details><summary><b>Show figure</b> - Differences in peak AST level (IU/L) after RLDRH vs ODRH</summary>

```{r ast2, fig.height=3, fig.width=16, echo=FALSE, message=FALSE, warning=FALSE}
ast2 <- subset(ast, comparison=='ODRH')

ast2_md <- md(ast2)

tast2 <- table_md(analysis = ast2_md, nstudies = 3, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Peak AST Level (IU/L)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tast2$b,
                      numbers = tast2$c,
                      fpPosition = ncol(tast2$b)-1,
                      xtick = c(-250, -150,-50, 0, 50, 150, 250),
                      sizes = c(rep(NA,3), 0.02*(ast2_md$pre$weights),NA, 1, NA),
                      bolding = c(T, rep(F, 6), T, F),
                      aligning = c('l', rep('c', 4), 'l', 'l'))

```

</details>



### Figure 12
<details><summary><b>Show figure</b> - Differences in peak total Bilirubin (mg/dL) after RLDRH vs LADRH</summary>

```{r bilirubin1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
bil <- subset(h1, outcome=='Peak Total Bilirubin')
bil1 <- subset(bil, comparison=='LADRH')

bil1_md <- md(bil1)

tbil1 <- table_md(analysis = bil1_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Peak Total Bilirubin (mg/dL)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tbil1$b,
                      numbers = tbil1$c,
                      fpPosition = ncol(tbil1$b),
                      xtick = c(-2,-1,0, 1,2),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
```

</details>



### Figure 13
<details><summary><b>Show figure</b> - Differences in peak total Bilirubin (mg/dL) after RLDRH vs ODRH</summary>

```{r bilirubin2, fig.height=3, fig.width=16, echo=FALSE, message=FALSE, warning=FALSE}
bil2 <- subset(bil, comparison=='ODRH')

bil2_md <- md(bil2)

tbil2 <- table_md(analysis = bil2_md, nstudies = 3, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Peak Total Bilirubin (mg/dL)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tbil2$b,
                      numbers = tbil2$c,
                      fpPosition = ncol(tbil2$b)-1,
                      xtick = c(-2,-1,0, 1,2),
                      sizes = c(rep(NA,3), 0.02*(bil2_md$pre$weights),NA, 1, NA),
                      bolding = c(T, rep(F, 6), T, F),
                      aligning = c('l', rep('c', 4), 'l', 'l'))
```


</details>



### Figure 14
<details><summary><b>Show figure</b> - Differences in total operative time (min) after RLDRH vs LADRH</summary>

```{r operativetime1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
surt <- subset(h1, outcome=='Total operative time')
surt1 <- subset(surt, comparison=='LADRH')

surt1_md <- md(surt1)

tsurt1 <- table_md(analysis = surt1_md, nstudies = 1, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Total operative time (min)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tsurt1$b,
                      numbers = tsurt1$c,
                      fpPosition = ncol(tsurt1$b),
                      xtick = c(250, 150, 50, 0, -50, -150, -250),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 4), 'l'))
```


</details>



### Figure 15
<details><summary><b>Show figure</b> - Differences in total operative time (min) after RLDRH vs ODRH</summary>

```{r operativetime2, fig.height=3, fig.width=16, echo=FALSE, message=FALSE, warning=FALSE}
surt2 <- subset(surt, comparison=='ODRH')

surt2_md <- md(surt2)

tsurt2 <- table_md(analysis = surt2_md, nstudies = 3, 
                    int = "RLDRH (n)", comp = "LADRH (n)",
                    outcome = 'Total operative time (min)', col = 'Mean (SD)', 
                    follow = FALSE)


plot <- plotmd_single_studies(words = tsurt2$b,
                      numbers = tsurt2$c,
                      fpPosition = ncol(tsurt2$b)-1,
                      xtick = c(-150, -50, 0, 50, 150, 250, 350),
                      sizes = c(rep(NA,3), 0.02*(surt2_md$pre$weights),NA, 1, NA),
                      bolding = c(T, rep(F, 7), T, F),
                      aligning = c('l', rep('c', 4), 'l', 'l'))

```

</details>


```{r cleaning_dichotomous_donor, echo=FALSE, message=FALSE, warning=FALSE}
d <- read.csv("6 Extracted Data/outcome_dichotomous_donor.csv")
d$outcomes2 <- paste(d$outcomes, d$definition)
d$comparison[d$comparison == 'NR'] <- NA

d2 <- d[!is.na(d$comparison),]

names(d2)[10] <- "n1"
names(d2)[11] <- "n2"
names(d2)[12] <- "e1"
names(d2)[13] <- "e2"

d2$comparison[d2$comparison == 'ORLDH'] <- 'ODRH'

d2[,c(9:13)] <- lapply(d2[,c(9:13)], as.numeric)


d2$author <- 
  ifelse(d2$refid==9, paste("Rho et al., 2020"),
  ifelse(d2$refid==27, paste("Broering et al., 2020"),
  ifelse(d2$refid==5, paste("Binoj et al., 2020"),
  ifelse(d2$refid==172, paste("Chen et al., 2016"),
  ifelse(d2$refid==74, paste("Cheah et al., 2019"),
  ifelse(d2$refid==239, paste("Martucci et al., 2013"),
  ifelse(d2$refid==277, paste("Giulianotti et al., 2011"), NA)))))))

```





### Figure 16
<details><summary><b>Show figure</b> - Risk of postoperative complications I-II after RLDRH vs LADRH</summary>

```{r LADRH_complication1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
compLADRH <- subset(d2, comparison=='LADRH')

comp1 <- subset(compLADRH, definition=='I-II')

comp1_rr <- rr(comp1)

tcomp1 <- table_rr(analysis = comp1_rr, nstudies = 1, 
                    int = "RLDRH", comp = "LADRH",
                    outcome = 'Complications')


plot <- plotrr_single_studies(words = tcomp1$b,
                      numbers = tcomp1$c,
                      fpPosition = ncol(tcomp1$b),
                      xtick = c(0.2,0.5,1,2,4),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 2), 'l'))
```
</details>



### Figure 17
<details><summary><b>Show figure</b> - Risk of postoperative complications III-IV after RLDRH vs LADRH</summary>


```{r LADRH_complication2, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
comp2 <- subset(compLADRH, definition=='III-IV')

comp2_rr <- rr(comp2)

tcomp2 <- table_rr(analysis = comp2_rr, nstudies = 1, 
                    int = "RLDRH", comp = "LADRH",
                    outcome = 'Complications')


plot <- plotrr_single_studies(words = tcomp2$b,
                      numbers = tcomp2$c,
                      fpPosition = ncol(tcomp2$b),
                      xtick = c(0.06, 0.25,0.5,1,2,4, 16),
                      sizes = c(rep(NA,3), 1, NA),
                      bolding = c(T, rep(F, 2), T, F),
                      aligning = c('l', rep('c', 2), 'l'))
```
</details>



### Figure 18
<details><summary><b>Show figure</b> - Risk of postoperative complications I-II after RLDRH vs ODRH</summary>

```{r ODRH_complication1, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
compODRH <- subset(d2, comparison=='ODRH')

comp3 <- subset(compODRH, definition=='I-II')

comp3_rr <- rr(comp3)

tcomp3 <- table_rr(analysis = comp3_rr, nstudies = 2, 
                    int = "RLDRH", comp = "ODRH",
                    outcome = 'Complications')


plot <- plotrr_single_studies(words = tcomp3$b,
                      numbers = tcomp3$c,
                      fpPosition = ncol(tcomp3$b),
                      xtick = c(0.12,0.25,0.5,1,2,4,8),
                      sizes = c(rep(NA,3), 0.008*(comp3_rr$pre$weights+50), NA, 1, NA),
                      bolding = c(T, rep(F, 6), T, F),
                      aligning = c('l', rep('c', 2), 'l', 'l'))
```


</details>



### Figure 19
<details><summary><b>Show figure</b> - Risk of postoperative complications I-II after RLDRH vs ODRH</summary>

```{r ODRH_complication2, fig.height=3, fig.width=14, echo=FALSE, message=FALSE, warning=FALSE}
comp4 <- subset(compODRH, definition=='III-IV')

comp4_rr <- rr(comp4)

tcomp4 <- table_rr(analysis = comp4_rr, nstudies = 2, 
                    int = "RLDRH", comp = "ODRH",
                    outcome = 'Complications')


plot <- plotrr_single_studies(words = tcomp4$b,
                      numbers = tcomp4$c,
                      fpPosition = ncol(tcomp4$b),
                      xtick = c(0.06,0.25,1,4,16),
                      sizes = c(rep(NA,3), 0.008*(comp4_rr$pre$weights+50), NA, 1, NA),
                      bolding = c(T, rep(F, 6), T, F),
                      aligning = c('l', rep('c', 2), 'l', 'l'))
```
</details>


